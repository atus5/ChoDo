<template>
    <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel" data-bs-interval="3000">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active"
                aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1"
                aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2"
                aria-label="Slide 3"></button>
        </div>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="https://voz.vn/attachments/untitled-1-jpg.502903/"
                    class="d-block w-100" alt="Banner 1">
                <div class="carousel-caption d-none d-md-block">
                </div>
            </div>
            <div class="carousel-item">
                <img src="https://voz.vn/attachments/untitled-3-jpg.502904/"
                    class="d-block w-100" alt="Banner 2">
                <div class="carousel-caption d-none d-md-block">
                </div>
            </div>
            <div class="carousel-item">
                <img src="https://voz.vn/attachments/untitled-2-jpg.502905/"
                    class="d-block w-100" alt="Banner 3">
                <div class="carousel-caption d-none d-md-block">
                </div>
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators"
            data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators"
            data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>

    <div class="container my-4">
        <!-- D·ªãch v·ª• Kh√¥ g√† Ch·ªô ƒê√≥ -->
        <div class="card p-4">
            <h3 class="text-center mb-4">D·ªäCH V·ª§ T·∫†I KH√î G√Ä CH·ªò ƒê√ì</h3>
            <div class="row text-center">
                <div class="col-md-3 mb-3">
                    <i class="fa fa-drumstick-bite fa-3x text-danger mb-2"></i>
                    <p>
                        <strong>Kh√¥ g√† lo·∫°i 1</strong><br />
                        <span class="text-muted">G√† ta n∆∞·ªõng th∆°m l·ª´ng, cay ƒë·ªôc quy·ªÅn. ƒÇn m·ªôt c√°i l√† 'ƒë·ªïi m√†u m·∫∑t' nh∆∞ng v·∫´n c·ª© ƒÉn ti·∫øp! üî•</span>
                    </p>
                </div>
                <div class="col-md-3 mb-3">
                    <i class="fa fa-leaf fa-3x text-success mb-2"></i>
                    <p>
                        <strong>B√£ m√≠a</strong><br />
                        <span class="text-muted">B√£ m√≠a kh√¥ t·ª´ 120 Y√™n L√£ng, d·∫ªo dai, v·ªã ng·ªçt t·ª± nhi√™n. ƒÇn k√®m kh√¥ g√† l√† 'n·∫∑ng l·ª≥' t·ª´ng b·ªØa! üéã</span>
                    </p>
                </div>
                <div class="col-md-3 mb-3">
                    <i class="fa fa-fire fa-3x text-warning  mb-2"></i>
                    <p>
                        <strong>Kh√¥ g√† lo·∫°i 2</strong><br />
                        <span class="text-muted">Kh√¥ g√† lo·∫°i 2 l√†m t·ª´ b√£ m√≠a ƒë√® team si√™u dai si√™u ngon üí¶</span>
                    </p>
                </div>
                <div class="col-md-3 mb-3">
                    <i class="fa fa-rocket fa-3x text-primary mb-2"></i>
                    <p>
                        <strong>Giao h√†ng nh∆∞ bay</strong><br />
                        <span class="text-muted">30 ph√∫t hay mi·ªÖn ph√≠! Con ch√≥ cao b·∫±ng b·ªô pc ch·∫°y nhanh h∆°n g√† b·ªã ƒëu·ªïi. Kh√¥ g√† v·∫´n n√≥ng h∆°i khi t·ªõi tay b·∫°n! üöÄ</span>
                    </p>
                </div>
            </div>
        </div>

        <!-- G·ª¢I √ù KH√î G√Ä H·∫§P D·∫™N -->
        <div class="featured-wrap my-5">
            <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between mb-3">
                <div>
                    <h3 class="mb-1 fw-bold">G·ª¢I √ù KH√î G√Ä H·∫§P D·∫™N</h3>
                    <p class="text-muted mb-0">Ch·ªçn ngay v·ªã kh√¥ g√† ƒëang ƒë∆∞·ª£c y√™u th√≠ch nh·∫•t h√¥m nay</p>
                </div>
                <router-link to="/phim/dang-chieu" class="mt-3 mt-md-0">
                    <button class="btn btn-danger rounded-pill">Kh√°m ph√° th√™m</button>
                </router-link>
            </div>
            <div class="row g-4">
                <template v-for="(item, index) in featuredList" :key="index">
                    <div class="col-xl-4 col-md-6">
                        <div class="card featured-card h-100 border-0 shadow-sm">
                            <div class="featured-thumb">
                                <img :src="getImageUrl(item.hinh_anh)" @error="handleImgError" loading="lazy" alt="" />
                                <span class="badge bg-danger featured-badge">B√°n ch·∫°y</span>
                                <div class="featured-rating">
                                    <i class="fa-solid fa-star"></i>
                                    <span>{{ formatRating(item) }}</span>
                                </div>
                            </div>
                            <div class="card-body">
                                <h5 class="fw-bold text-dark mb-2">{{ item.ten_phim }}</h5>
                                <p class="text-muted small mb-3">{{ item.the_loai || 'Kh√¥ g√† ƒë·∫∑c bi·ªát' }}</p>
                                <div class="d-flex align-items-center">
                                    <div class="fw-bold text-danger fs-5">{{ formatVND(item.thoi_luong) }}</div>
                                    <router-link :to="`/chi-tiet-phim/${item.id}`" class="ms-auto">
                                        <button class="btn btn-outline-danger btn-sm">Mua ngay</button>
                                    </router-link>
                                </div>
                            </div>
                        </div>
                    </div>
                </template>
            </div>
        </div>

        <!-- Kh√¥ g√† b√°n ch·∫°y -->
        <h3 class="text-center">KH√î G√Ä HOT CH·ªò ƒê√ì</h3>
        <div class="row mt-4">
            <template v-for="(value, index) in dangBanList" :key="index">
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="card position-relative shadow-sm">
                        <img :src="getImageUrl(value.hinh_anh)" @error="handleImgError" loading="lazy" class="card-img-top" alt=""
                            style="height: 400px; object-fit: cover;">
                        <div class="card-body">
                            <h6 class="card-title text-warning fw-bold">{{ value.ten_phim }}</h6>
                            <p class="text-muted mb-1">{{ value.the_loai }}</p>
                            <div class="d-flex align-items-center mb-2">
                                <span class="text-warning me-1">
                                    <i class="fa-solid fa-star"></i>
                                    <i class="fa-solid fa-star"></i>
                                    <i class="fa-solid fa-star"></i>
                                    <i class="fa-solid fa-star"></i>
                                    <i class="fa-solid fa-star-half-stroke"></i>
                                    {{ formatRating(value) }}
                                </span>
                                <span class="ms-auto fw-bold">
                                    <router-link :to="`/chi-tiet-phim/${value.id}`">
                                        <a href="#" class="btn btn-outline-danger w-100">Mua kh√¥ g√†</a>
                                    </router-link>
                                </span>
                            </div>

                        </div>
                    </div>
                </div>
            </template>
        </div>

        <div class="text-center mb-4">
            <router-link to="/phim/dang-chieu">
                <button class="btn btn-outline-danger rounded-pill">Xem t·∫•t c·∫£ c√°c lo·∫°i kh√¥ g√†</button>
            </router-link>
        </div>

        <!-- V·ªÅ ch√∫ng t√¥i -->
        <div class="card p-5 border-0 shadow-sm rounded-4" style="background-color: #000957;">
            <h3 class="text-center text-uppercase fw-bold mb-5 text-light">V·ªÅ ch√∫ng t√¥i</h3>
            <div class="row align-items-center">
                <!-- N·ªôi dung b√™n tr√°i -->
                <div class="col-md-7">
                    <h4 class="fw-bold mb-3">
                        <span class="text-danger">Mua kh√¥ g√† th∆°m l≈©ng </span>
                        <span class="text-primary">Online </span>
                        <span class=" text-light">tr√™n Kh√¥ g√† Ch·ªô ƒê√≥</span>
                    </h4>
                    <p class="text-light fs-5 mb-4">
                        Tr·∫£i nghi·ªám mua kh√¥ g√† tr·ª±c tuy·∫øn d·ªÖ d√†ng, nhi·ªÅu ∆∞u ƒë√£i h·∫•p d·∫´n v√† k·∫øt n·ªëi v·ªõi c√°c c·ª•m b√°n kh√¥ g√† l·ªõn tr√™n
                        to√†n qu·ªëc.
                    </p>
                    <ul class="list-unstyled fs-5">
                        <li class="mb-3 d-flex align-items-start">
                            <i class="fa fa-check-circle text-success me-2 mt-1"></i>
                            <span class="text-light">Mua kh√¥ g√† Online, tr·∫£i nghi·ªám kh√¥ g√† ngon</span>
                        </li>
                        <li class="mb-3 d-flex align-items-start">
                            <i class="fa fa-check-circle text-success me-2 mt-1"></i>
                            <span class="text-light">ƒê·∫∑t kh√¥ g√† an to√†n, ti·ªán l·ª£i trong v√†i b∆∞·ªõc</span>
                        </li>
                        <li class="mb-3 d-flex align-items-start">
                            <i class="fa fa-check-circle text-success me-2 mt-1"></i>
                            <span class="text-light">T·ª± do ch·ªçn lo·∫°i kh√¥ g√†, combo gia v·ªã si√™u hot</span>
                        </li>
                        <li class="mb-3 d-flex align-items-start">
                            <i class="fa fa-check-circle text-success me-2 mt-1"></i>
                            <span class="text-light">L∆∞u l·ªãch s·ª≠ ƒë·∫∑t h√†ng, qu·∫£n l√Ω ƒë∆°n h√†ng d·ªÖ d√†ng</span>
                        </li>
                    </ul>
                </div>

                <!-- ·∫¢nh b√™n ph·∫£i -->
                <div class="col-md-5 text-center">
                    <img src="https://media.baamboozle.com/uploads/images/55836/1682378705_349492_import-url.png"
                        alt="Mua kh√¥ g√† online" class="img-fluid rounded-3 shadow-sm">
                </div>
            </div>
        </div>


        <!-- KH√î G√Ä S·∫ÆP B√ÅN -->
        <h3 class="text-center mb-4">KH√î G√Ä S·∫ÆP B√ÅN</h3>
        <div class="row">
            <template v-for="(value, index) in sapBanList" :key="index">
                <div class="col-md-3 mb-4 d-flex">
                    <div class="card flex-full w-100" style="background-color: #FFF2F2;">
                        <img :src="getImageUrl(value.hinh_anh)" @error="handleImgError" loading="lazy" class="card-img-top" style="height: 350px; object-fit: cover;">
                        <div class="card-body">
                            <span class="badge bg-danger mb-2">{{ 100000 + index * 2000 }} ng∆∞·ªùi ƒë√£ mua</span>
                            <h5 class="card-title text-truncate text-warning">{{ value.ten_phim }}</h5>
                            <p class="card-text">{{ value.the_loai }}</p>
                            <button class="btn btn-outline-danger btn-sm mt-2">Nh·∫Øc t√¥i</button>
                        </div>
                    </div>
                </div>
            </template>
        </div>
        <div class="text-center">
            <router-link to="/phim/sap-chieu">
                <button class="btn btn-outline-danger rounded-pill ">Xem t·∫•t c·∫£ c√°c lo·∫°i kh√¥ g√†</button>
            </router-link>
        </div>

        <!-- DANH S√ÅCH KH√îG√Ä PH·ª§ V·ª§ QU√ÅN ƒÇN -->
        <div style="background-color: #FFF2F2; padding: 40px 20px; margin: 40px 0; border-radius: 10px;">
            <h3 class="text-center mb-4">KH√î G√Ä PH·ª§C V·ª§ QU√ÅN ƒÇN, NH√Ä H√ÄNG</h3>
            <div class="row">
                <template v-for="(value, index) in list_phim.slice(4, 8)" :key="index">
                    <div class="col-lg-3 col-md-6 mb-4">
                        <div class="card position-relative shadow-sm h-100">
                            <img :src="getImageUrl(value.hinh_anh)" @error="handleImgError" loading="lazy" class="card-img-top" alt=""
                                style="height: 350px; object-fit: cover;">
                            <div class="card-body">
                                <h6 class="card-title text-danger fw-bold">{{ value.ten_phim }}</h6>
                                <p class="text-muted small mb-2">Th√†nh ph·∫ßn: {{ value.dien_vien }}</p>
                                <p class="text-muted small">{{ value.the_loai }}</p>
                                <div class="d-flex gap-2 mt-3">
                                    <router-link :to="`/chi-tiet-phim/${value.id}`" class="flex-grow-1">
                                        <button class="btn btn-danger btn-sm w-100">Xem chi ti·∫øt</button>
                                    </router-link>
                                    <button class="btn btn-outline-danger btn-sm">
                                        <i class="fa fa-heart"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </template>
            </div>
            <div class="text-center">
                <router-link to="/phim/dang-chieu">
                    <button class="btn btn-danger rounded-pill">Xem t·∫•t c·∫£ ƒë·ªÉ cung c·∫•p cho qu√°n</button>
                </router-link>
            </div>
        </div>

        <!-- TIN T·ª®C V√Ä H∆Ø·ªöNG D·∫™N -->
        <h3 class="text-center mb-4 mt-5">TIN T·ª®C V√Ä H∆Ø·ªöNG D·∫™N</h3>
        <p class="text-center text-muted mb-4">C·∫≠p nh·∫≠t nh·ªØng b√†i vi·∫øt hay v·ªÅ c√°ch ch·ªçn, b·∫£o qu·∫£n v√† n·∫•u kh√¥ g√†</p>
        <div class="row">
            <template v-for="(value, index) in getArticles()" :key="index">
                <div class="col-lg-4 mb-4">
                    <div class="card h-100 shadow-sm border-0 overflow-hidden article-card">
                        <div class="position-relative" style="height: 250px; overflow: hidden;">
                            <img :src="getImageUrl(value.hinh_anh)" @error="handleImgError" loading="lazy" class="card-img-top" style="height: 100%; object-fit: cover;">
                            <div class="position-absolute top-0 start-0 badge bg-danger" style="margin: 10px;">
                                <i class="fa fa-calendar-days me-1"></i>{{ formatDate(value.ngay_dang) }}
                            </div>
                        </div>
                        <div class="card-body d-flex flex-column">
                            <router-link :to="`/chi-tiet-bai-viet/${value.id}`">
                                <h5 class="card-title fw-bold text-dark article-title">{{ value.tieu_de }}</h5>
                            </router-link>
                            <p class="card-text text-muted flex-grow-1">{{ value.mo_ta_ngan || value.mo_ta }}</p>
                            <router-link :to="`/chi-tiet-bai-viet/${value.id}`" class="btn btn-outline-danger btn-sm">
                                ƒê·ªçc th√™m <i class="fa fa-arrow-right ms-1"></i>
                            </router-link>
                        </div>
                    </div>
                </div>
            </template>
        </div>
        <div class="text-center mb-5">
            <router-link to="/bai-viet">
                <button class="btn btn-outline-danger rounded-pill">Xem t·∫•t c·∫£ b√†i vi·∫øt</button>
            </router-link>
        </div>
        <h3 class="text-center mb-4 fw-bold ">Kh√°ch H√†ng N√≥i G√¨ V·ªÅ Kh√¥ g√† Ch·ªô ƒê√≥?</h3>
        <div class="row justify-content-center">
            <div class="col-md-4 mb-3">
                <div class="card h-100 shadow-sm " style="background-color: #000957;">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-2">
                            <img src="https://voz.vn/attachments/542754057_1467285577853420_8471185407916019492_n-jpg.3225827/" alt="avatar"
                                class="rounded-circle me-3" width="48" height="48">
                            <div>
                                <div class="fw-bold text-light">La Qu√Ω X∆∞a</div>
                                <div class="text-muted text-light" style="font-size: 0.95em;">CEO Kh√¥ g√† Ch·ªô ƒê√≥</div>
                            </div>
                        </div>
                        <div class="mb-2">
                            <span class="text-warning">&#9733;</span>
                            <span class="text-warning">&#9733;</span>
                            <span class="text-warning">&#9733;</span>
                            <span class="text-warning">&#9733;</span>
                            <span class="text-warning">&#9733;</span>
                        </div>
                        <div class="fst-italic text-light" style="font-size: 1em;">
                            "T√¥i ƒÉn h·∫øt m·ªôt g√≥i kh√¥ g√† trong 10 ph√∫t, r·ªìi n·∫±m lƒÉn ra v√¨ cay! V·ªã cay t·ª´ ƒë·ªãa ng·ª•c nh∆∞ng ngon v√¥ c√πng. Ch·∫Øc ch·∫Øn mua ti·∫øp üò≠üî•"
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-3">
                <div class="card h-100 shadow-sm " style="background-color: #000957;">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-2">
                            <img src="https://voz.vn/attachments/images-12-jpeg.3334479/" alt="avatar"
                                class="rounded-circle me-3" width="48" height="48">
                            <div>
                                <div class="fw-bold text-light">Ph·∫°m Ch√≠ X∆∞a</div>
                                <div class="text-muted text-light" style="font-size: 0.95em;">Gi√°m ƒë·ªëc Kh√¥ g√† Ch·ªô ƒê√≥</div>
                            </div>
                        </div>
                        <div class="mb-2">
                            <span class="text-warning">&#9733;</span>
                            <span class="text-warning">&#9733;</span>
                            <span class="text-warning">&#9733;</span>
                            <span class="text-warning">&#9733;</span>
                            <span class="text-warning">&#9733;</span>
                        </div>
                        <div class="fst-italic text-light" style="font-size: 1em;">
                            "Giao h√†ng 30 ph√∫t m√† t√¥i ch·ªâ ƒë·ª£i 15 ph√∫t! Kh√¥ g√† v·∫´n ·∫•m, v·∫´n gi√≤n. Anh/ch·ªã shipper ch·∫°y nhanh h∆°n g√† s·ª£ k√™u! Cho 5 sao üí®"
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-3">
                <div class="card h-100 shadow-sm " style="background-color: #000957;">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-2">
                            <img src="https://voz.vn/attachments/542754057_1467285577853420_8471185407916019492_n-jpg.3225827/" alt="avatar"
                                class="rounded-circle me-3" width="48" height="48">
                            <div>
                                <div class="fw-bold text-light">Tr·∫ßn C·∫£nh X∆∞a</div>
                                <div class="text-muted text-light" style="font-size: 0.95em;">Ch·ªß c·ª≠a h√†ng Kh√¥ g√† Ch·ªô ƒê√≥</div>
                            </div>
                        </div>
                        <div class="mb-2">
                            <span class="text-warning">&#9733;</span>
                            <span class="text-warning">&#9733;</span>
                            <span class="text-warning">&#9733;</span>
                            <span class="text-warning">&#9733;</span>
                            <span class="text-warning">&#9733;</span>
                        </div>
                        <div class="fst-italic text-light" style="font-size: 1em;">
                            "Combo gia v·ªã gi√° h·ª£p l√Ω, kh√¥ g√† m·ªõi c·∫≠p nh·∫≠t li√™n t·ª•c, h·ªá th·ªëng l·ª±a ch·ªçn kh√¥ g√† ƒëa d·∫°ng ‚Äì Kh√¥ g√† Ch·ªô ƒê√≥
                            l√† l·ª±a 'S√°t T·ª≠' ch·ªâ c·∫ßn ƒÉn m·ªôt l·∫ßn l√† nghi·ªán! L·∫ßn t·ªõi mua combo kh√°c k·∫ªo cay h·∫øt t·∫•t c·∫£ ch√¢n tay üòÇ. Website d·ªÖ d√πng l·∫Øm!
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


</template>

<script>
import axios from 'axios'
export default {
    data() {
        return {
            list_phim: [],
            list_bv: [],
            isLoading: false,
            defaultArticles: [
                {
                    id: 1,
                    tieu_de: "5 C√°ch N·∫•u Kh√¥ G√† Ngon ƒê·∫°t ƒê·ªânh M√† B·∫°n Ph·∫£i Th·ª≠",
                    mo_ta_ngan: "Kh√¥ g√† kh√¥ng ch·ªâ ƒÉn s·ªëng m√† c√≤n c√≥ th·ªÉ n·∫•u th√†nh nhi·ªÅu m√≥n ƒÉn ngon kh√°c nhau. H√¥m nay ch√∫ng t√¥i s·∫Ω chia s·∫ª 5 c√°ch n·∫•u kh√¥ g√† ƒë∆°n gi·∫£n nh∆∞ng c·ª±c ngon.",
                    mo_ta: "Kh√¥ g√† kh√¥ng ch·ªâ ƒÉn s·ªëng m√† c√≤n c√≥ th·ªÉ n·∫•u th√†nh nhi·ªÅu m√≥n ƒÉn ngon kh√°c nhau. T·ª´ canh, x√†o ƒë·∫øn n∆∞·ªõc l·∫©u, kh√¥ g√† l√∫c n√†o c≈©ng l√† nguy√™n li·ªáu tuy·ªát v·ªùi.",
                    hinh_anh: "https://voz.vn/attachments/untitled-1-jpg.502903/",
                    ngay_dang: new Date(2024, 0, 15)
                },
                {
                    id: 2,
                    tieu_de: "B√≠ K√≠p Ch·ªçn Kh√¥ G√† Ch·∫•t L∆∞·ª£ng Cao T·∫°i Ch·ªô ƒê√≥",
                    mo_ta_ngan: "L√†m sao ƒë·ªÉ ch·ªçn ƒë∆∞·ª£c kh√¥ g√† t∆∞∆°i, ngon v√† ch·∫•t l∆∞·ª£ng cao? H√£y c√πng ch√∫ng t√¥i kh√°m ph√° nh·ªØng ti√™u ch√≠ quan tr·ªçng khi l·ª±a ch·ªçn kh√¥ g√†.",
                    mo_ta: "Kh√¥ g√† l√† m·ªôt s·∫£n ph·∫©m c√≥ gi√° tr·ªã dinh d∆∞·ª°ng cao v√† r·∫•t ƒë∆∞·ª£c y√™u th√≠ch. Nh∆∞ng kh√¥ng ph·∫£i l√∫c n√†o ch√∫ng ta c≈©ng bi·∫øt c√°ch ch·ªçn kh√¥ g√† t·ªët nh·∫•t.",
                    hinh_anh: "https://voz.vn/attachments/untitled-2-jpg.502905/",
                    ngay_dang: new Date(2024, 0, 12)
                },
                {
                    id: 3,
                    tieu_de: "Kh√¥ G√† Ch·ªô ƒê√≥ - H√†nh Tr√¨nh T·ª´ Y√™n L√£ng ƒê·∫øn B√†n ƒÇn C·ªßa B·∫°n",
                    mo_ta_ngan: "T·ª´ nh·ªØng g√† ta t·ª± nhi√™n t·∫°i Y√™n L√£ng, qua qu√° tr√¨nh ch·∫ø bi·∫øn t·ªâ m·ªâ ƒë·∫øn khi ƒë∆∞·ª£c g·ª≠i ƒë·∫øn tay b·∫°n, m·ªói s·∫£n ph·∫©m kh√¥ g√† Ch·ªô ƒê√≥ l√† m·ªôt c√¢u chuy·ªán.",
                    mo_ta: "Kh√¥ g√† Ch·ªô ƒê√≥ kh√¥ng ph·∫£i ch·ªâ l√† m·ªôt s·∫£n ph·∫©m ƒÉn v·∫∑t, m√† l√† k·∫øt qu·∫£ c·ªßa s·ª± t√¢m huy·∫øt v√† ch·∫•t l∆∞·ª£ng trong t·ª´ng b∆∞·ªõc ch·∫ø bi·∫øn.",
                    hinh_anh: "https://voz.vn/attachments/untitled-3-jpg.502904/",
                    ngay_dang: new Date(2024, 0, 10)
                },
                {
                    id: 4,
                    tieu_de: "C√°ch B·∫£o Qu·∫£n Kh√¥ G√† ƒê·ªÉ Gi·ªØ ƒê∆∞·ª£c ƒê·ªô T∆∞∆°i Ngon L√¢u Nh·∫•t",
                    mo_ta_ngan: "B·∫£o qu·∫£n kh√¥ g√† ƒë√∫ng c√°ch l√† ch√¨a kh√≥a ƒë·ªÉ duy tr√¨ h∆∞∆°ng v·ªã v√† ch·∫•t l∆∞·ª£ng c·ªßa s·∫£n ph·∫©m trong th·ªùi gian d√†i.",
                    mo_ta: "Ngo√†i ch·∫•t l∆∞·ª£ng kh√¥ g√†, c√°ch b·∫£o qu·∫£n c≈©ng ·∫£nh h∆∞·ªüng r·∫•t l·ªõn ƒë·∫øn h∆∞∆°ng v·ªã cu·ªëi c√πng c·ªßa s·∫£n ph·∫©m.",
                    hinh_anh: "https://voz.vn/attachments/untitled-1-jpg.502903/",
                    ngay_dang: new Date(2024, 0, 8)
                },
                {
                    id: 5,
                    tieu_de: "Kh√¥ G√† v√† S·ª©c Kh·ªèe - Nh·ªØng T√°c D·ª•ng Tuy·ªát V·ªùi B·∫°n Ch∆∞a Bi·∫øt",
                    mo_ta_ngan: "Kh√¥ g√† kh√¥ng ch·ªâ ngon m√† c√≤n r·∫•t t·ªët cho s·ª©c kh·ªèe. H√£y c√πng kh√°m ph√° nh·ªØng t√°c d·ª•ng tuy·ªát v·ªùi c·ªßa kh√¥ g√† ƒë·ªëi v·ªõi c∆° th·ªÉ ch√∫ng ta.",
                    mo_ta: "V·ªõi l∆∞·ª£ng protein cao v√† ch·∫•t dinh d∆∞·ª°ng phong ph√∫, kh√¥ g√† l√† l·ª±a ch·ªçn tuy·ªát v·ªùi cho nh·ªØng ai quan t√¢m ƒë·∫øn s·ª©c kh·ªèe.",
                    hinh_anh: "https://voz.vn/attachments/untitled-2-jpg.502905/",
                    ngay_dang: new Date(2024, 0, 5)
                },
                {
                    id: 6,
                    tieu_de: "Combo Gia V·ªã C·ª±c Hot - K·∫øt H·ª£p Ho√†n H·∫£o Cho Kh√¥ G√†",
                    mo_ta_ngan: "Kh√¥ g√† Ch·ªô ƒê√≥ tung ra b·ªô s∆∞u t·∫≠p combo gia v·ªã m·ªõi, ƒëem ƒë·∫øn nh·ªØng tr·∫£i nghi·ªám h∆∞∆°ng v·ªã m·ªõi l·∫° v√† k√≠ch th√≠ch v·ªã gi√°c.",
                    mo_ta: "M·ªói combo gia v·ªã ƒë·ªÅu ƒë∆∞·ª£c ch·ªçn l·ªçc k·ªπ l∆∞·ª°ng ƒë·ªÉ k·∫øt h·ª£p ho√†n h·∫£o v·ªõi kh√¥ g√†, t·∫°o n√™n nh·ªØng m√≥n ƒÉn ƒë·ªôc ƒë√°o v√† h·∫•p d·∫´n.",
                    hinh_anh: "https://voz.vn/attachments/untitled-3-jpg.502904/",
                    ngay_dang: new Date(2024, 0, 1)
                }
            ]
        }
    },
    mounted() {
        this.loadData();
    },
    computed: {
        dangBanList() {
            return this.filterByStatus(this.list_phim, 2).slice(0, 4);
        },
        featuredList() {
            return this.filterByStatus(this.list_phim, 2).slice(0, 3);
        },
        sapBanList() {
            return this.filterByStatus(this.list_phim, 1).slice(0, 4);
        }
    },
    methods: {
        getImageUrl(imagePath) {
            const fallback = 'https://placehold.co/800x500?text=Kho+Ga';

            if (!imagePath) return fallback;

            if (/^https?:\/\//i.test(imagePath)) return imagePath;

            if (imagePath.startsWith('/')) return `${axios.defaults.baseURL}${imagePath}`;

            if (imagePath.startsWith('storage/')) return `${axios.defaults.baseURL}/${imagePath}`;

            return `${axios.defaults.baseURL}/storage/${imagePath}`;
        },
        handleImgError(event) {
            event.target.src = 'https://placehold.co/800x500?text=Kho+Ga';
        },
        formatRating(item) {
            const raw = item?.tinh_trang ?? item?.danh_gia;
            const num = Number(raw);
            if (Number.isFinite(num)) {
                const rating = Math.min(Math.max(num, 0), 10);
                return Number.isInteger(rating) ? rating.toString() : rating.toFixed(1);
            }
            if (typeof raw === 'string' && raw.trim()) return raw.trim();
            return '0';
        },
        formatVND(amount) {
            const value = Number(amount);
            if (!Number.isFinite(value)) return '0 ‚Ç´';
            return new Intl.NumberFormat('vi-VN', {
                style: 'currency',
                currency: 'VND'
            }).format(value);
        },
        filterByStatus(list, status) {
            const arr = Array.isArray(list) ? list : [];
            const filtered = arr.filter((item) => Number(item?.tinh_trang) === status);
            return filtered.length ? filtered : arr;
        },
        getArticles() {
            // N·∫øu c√≥ d·ªØ li·ªáu t·ª´ server, s·ª≠ d·ª•ng. N·∫øu kh√¥ng, d√πng d·ªØ li·ªáu m·∫∑c ƒë·ªãnh
            return this.list_bv && this.list_bv.length > 0 
                ? this.list_bv.slice(0, 6)
                : this.defaultArticles;
        },
        formatDate(date) {
            if (!date) return '';
            const d = new Date(date);
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            return `${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`;
        },
        loadData() {
            this.isLoading = true;

            const frontendBase = window.location.origin;
            const requests = [
                axios.get('/api/client/phim/get-data', { timeout: 6000 }),
                axios.get('/api/client/chi-tiet-kho-ga/get-data', { timeout: 6000 }),
                axios.get('/api/client/home-page', { timeout: 6000 }),
                axios.get('/phim-data.json', { baseURL: frontendBase, timeout: 3000 })
            ];

            Promise.allSettled(requests)
                .then((results) => {
                    const [phimRes, khoGaRes, homeRes, jsonRes] = results;
                    const statusOk = (res) => res?.value?.data?.status === true || res?.value?.data?.status === 'success';

                    if (phimRes.status === 'fulfilled' && statusOk(phimRes.value) && Array.isArray(phimRes.value.data.data)) {
                        this.list_phim = phimRes.value.data.data.map((item) => ({
                            id: item.id,
                            ten_phim: item.ten_phim,
                            hinh_anh: item.hinh_anh,
                            mo_ta: item.mo_ta,
                            tinh_trang: item.tinh_trang,
                            the_loai: item.ten_the_loai || item.the_loai,
                            thoi_luong: item.thoi_luong,
                            dien_vien: item.dien_vien,
                        }));
                    }

                    // Fallback sang chi-tiet-kho-ga n·∫øu danh s√°ch tr·ªëng
                    if (!this.list_phim.length && khoGaRes.status === 'fulfilled' && statusOk(khoGaRes.value)) {
                        this.list_phim = khoGaRes.value.data.data.map(item => ({
                            id: item.id,
                            ten_phim: item.ten_kho_ga,
                            hinh_anh: item.hinh_anh,
                            mo_ta: item.mo_ta,
                            tinh_trang: item.tinh_trang,
                            the_loai: item.loai_vi
                        }));
                    }

                    const jsonItems = Array.isArray(jsonRes.value?.data)
                        ? jsonRes.value.data
                        : Array.isArray(jsonRes.value?.data?.data)
                            ? jsonRes.value.data.data
                            : [];

                    if (!this.list_phim.length && jsonRes.status === 'fulfilled' && jsonItems.length) {
                        this.list_phim = jsonItems.map((item) => ({
                            id: item.id,
                            ten_phim: item.ten_phim,
                            hinh_anh: item.hinh_anh,
                            mo_ta: item.mo_ta,
                            tinh_trang: item.tinh_trang,
                            the_loai: item.ten_the_loai || item.the_loai,
                            thoi_luong: item.thoi_luong,
                            dien_vien: item.dien_vien,
                        }));
                    }

                    if (homeRes.status === 'fulfilled' && homeRes.value?.data?.data_bv) {
                        this.list_bv = homeRes.value.data.data_bv;
                    }

                    // N·∫øu v·∫´n kh√¥ng c√≥ d·ªØ li·ªáu t·ª´ server, ƒë·ªÉ tr·ªëng v√† b√°o l·ªói
                    if (!this.list_phim.length) {
                        this.list_phim = [];
                    }

                    if (!this.list_bv.length) {
                        this.list_bv = [];
                    }
                })
                .catch((err) => {
                    console.error('Load home page error:', err);
                    this.$toast?.error?.('Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu trang ch·ªß');
                })
                .finally(() => {
                    this.isLoading = false;
                })
        }
    }
}
</script>

<style scoped>
.carousel-item {
    height: 400px;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #f0f0f0;
}

.carousel-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.carousel {
    position: relative;
}

.carousel-inner {
    position: relative;
    width: 100%;
    overflow: hidden;
}

.carousel-item {
    display: none;
    float: left;
    width: 100%;
    margin-right: -100%;
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    transition: transform 0.6s ease-in-out;
}

.carousel-item.active {
    display: block;
}

.carousel-item-next,
.carousel-item-prev {
    display: block;
}

.carousel-item-next {
    transform: translateX(100%);
}

.carousel-item-prev {
    transform: translateX(-100%);
}

.carousel-item-next.carousel-item-start,
.carousel-item-prev.carousel-item-end {
    transform: translateX(0);
}

.carousel-item-start {
    transform: translateX(-100%);
}

.carousel-item-end {
    transform: translateX(100%);
}

.article-card {
    transition: all 0.3s ease;
}

.article-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15) !important;
}

.article-title {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    transition: color 0.3s ease;
}

.article-card:hover .article-title {
    color: #dc3545;
}

.article-card a {
    text-decoration: none;
}

.featured-wrap {
    background: linear-gradient(135deg, #fff7f7, #ffffff);
    border-radius: 20px;
    padding: 28px;
}

.featured-card {
    border-radius: 16px;
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.featured-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12) !important;
}

.featured-thumb {
    position: relative;
    height: 220px;
    overflow: hidden;
}

.featured-thumb img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
}

.featured-card:hover .featured-thumb img {
    transform: scale(1.05);
}

.featured-badge {
    position: absolute;
    top: 14px;
    left: 14px;
    padding: 6px 12px;
    border-radius: 999px;
    font-size: 0.75rem;
    letter-spacing: 0.4px;
}

.featured-rating {
    position: absolute;
    bottom: 12px;
    right: 12px;
    background: rgba(0, 0, 0, 0.65);
    color: #fff;
    padding: 6px 10px;
    border-radius: 999px;
    font-size: 0.85rem;
    display: flex;
    align-items: center;
    gap: 6px;
}
</style>